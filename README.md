<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

<!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Your-health-assistant | This site will help you stay safe at all times. And it will give your loved ones peace of mind and certainty.</title>
<meta name="generator" content="Jekyll v3.10.0" />
<meta property="og:title" content="Your-health-assistant" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="This site will help you stay safe at all times. And it will give your loved ones peace of mind and certainty." />
<meta property="og:description" content="This site will help you stay safe at all times. And it will give your loved ones peace of mind and certainty." />
<link rel="canonical" href="https://kiljch-creator.github.io/Your-health-assistant/" />
<meta property="og:url" content="https://kiljch-creator.github.io/Your-health-assistant/" />
<meta property="og:site_name" content="Your-health-assistant" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Your-health-assistant" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebSite","description":"This site will help you stay safe at all times. And it will give your loved ones peace of mind and certainty.","headline":"Your-health-assistant","name":"Your-health-assistant","url":"https://kiljch-creator.github.io/Your-health-assistant/"}</script>
<!-- End Jekyll SEO tag -->

    <link rel="stylesheet" href="/Your-health-assistant/assets/css/style.css?v=c5e29d734cc3c8c6b7fa4885c6e57491b7a1aeda">
    <!-- start custom head snippets, customize with your own _includes/head-custom.html file -->

<!-- Setup Google Analytics -->



<!-- You can set your favicon here -->
<!-- link rel="shortcut icon" type="image/x-icon" href="/Your-health-assistant/favicon.ico" -->

<!-- end custom head snippets -->

  </head>
  <body>
    <div class="container-lg px-3 my-5 markdown-body">
      

      <h1 id="your-health-assistant">Your-health-assistant</h1>
<p>This site will help you stay safe at all times. And it will give your loved ones peace of mind and certainty.</p>
<html lang="uk">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>MED-BRASLET ‚Äî Medical Profile</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&amp;display=swap" rel="stylesheet" />
<style>
:root{
    --bg-light: #ffffff;
    --bg-dark: #0b0b0b;
    --card-light: #fff;
    --card-dark: #111;
    --text-light: #0b0b0b;
    --text-dark: #ffffff;
    --accent-red: #b71c1c;
    --accent-red-2: #800000;
    --muted-light: #666;
    --muted-dark: #cfcfcf;
    --input-bg-light: rgba(0,0,0,0.03);
    --input-bg-dark: rgba(255,255,255,0.03);
    --preview-row-light: rgba(0,0,0,0.05);
    --preview-row-dark: rgba(255,255,255,0.05);
    --radius: 12px;
}
html,body{height:100%}
body{
    margin:0;padding:18px;font-family:Inter,system-ui, Arial, sans-serif;
    background:var(--bg-light);color:var(--text-light);
    transition: background .3s, color .3s;
}
body.dark{
    background:var(--bg-dark);color:var(--text-dark);
}
.logo, .avatar {
    background: #000; color: #fff;
    width:52px;height:52px;border-radius:10px;
    display:flex;align-items:center;justify-content:center;
    font-weight:700;
    transition: background .3s, color .3s;
}
.avatar { width: 84px; height: 84px; font-size: 20px; }
body.dark .logo, body.dark .avatar { background: #fff; color: #000; }
.app{max-width:1100px;margin:0 auto;display:grid;grid-template-columns:1fr 380px;gap:18px;align-items:start}
@media (max-width:980px){.app{grid-template-columns:1fr;padding:12px}.rightCol{order:-1}}
header{display:flex;justify-content:space-between;align-items:center;gap:12px;margin-bottom:10px}
.brand{display:flex;align-items:center;gap:12px}
h1{margin:0;font-size:18px}
h2{font-size: 1.4em; margin-top: 0;}
.subtitle{font-size:13px;color:var(--muted-light)}
body.dark .subtitle{color:var(--muted-dark)}
.card{
    background:var(--card-light);
    border-radius:var(--radius);
    padding:16px;
    border:1px solid rgba(0,0,0,0.04);
    box-shadow:0 10px 30px rgba(0,0,0,0.06);
    transition: background .3s, border-color .3s, box-shadow .3s;
}
body.dark .card{background:var(--card-dark);border:1px solid rgba(255,255,255,0.03);box-shadow:none}
#formCard {
    transition: opacity 0.5s ease-in-out, margin 0.5s ease-in-out, padding 0.5s ease-in-out, border 0.5s ease-in-out, box-shadow 0.5s ease-in-out, height 0.5s ease-in-out;
}
#formCard.hidden {
    opacity: 0;
    height: 0;
    padding-top: 0;
    padding-bottom: 0;
    margin: 0;
    border: none;
    box-shadow: none;
    overflow: hidden;
}
label{display:block;font-size:14px;margin-bottom:6px;color:var(--muted-light)}
body.dark label{color:var(--muted-dark)}
#profileForm > div { margin-bottom: 12px; }
input[type="text"], input[type="number"], select, textarea{
    width:100%;padding:10px 12px;border-radius:10px;border:1px solid rgba(0,0,0,0.06);background:var(--input-bg-light);color:var(--text-light);font-size:15px;outline:none;
    box-sizing: border-box;
    transition: background-color .2s, border-color .2s;
}
input[type="text"]:focus, input[type="number"]:focus, select:focus, textarea:focus {
    border-color: var(--accent-red-2);
    box-shadow: 0 0 0 1px var(--accent-red-2);
}
body.dark input[type="text"], body.dark input[type="number"], body.dark select, body.dark textarea {
    background:var(--input-bg-dark); color:var(--text-dark); border:1px solid rgba(255,255,255,0.04);
}
body.dark input[type="text"]:focus, body.dark input[type="number"]:focus, body.dark select:focus, body.dark textarea:focus {
    border-color: var(--accent-red);
    box-shadow: 0 0 0 1px var(--accent-red);
}
select[multiple]{
    min-height: 40px;
    height: auto;
    max-height: 150px;
    padding: 0;
    line-height: 1.2;
    overflow-y: auto;
    -webkit-appearance: none;
    -moz-appearance: none;
    appearance: none;
    cursor: default;
}
select[multiple] option {
    padding: 8px 12px;
}
select[multiple] option:checked {
    background-color: var(--accent-red-2);
    color: white;
}
select[multiple] option:hover {
    background-color: rgba(0,0,0,0.05);
}
body.dark select[multiple] option:hover {
    background-color: rgba(255,255,255,0.05);
}
.hint{font-size:13px;color:var(--muted-light);margin-bottom:6px}
body.dark .hint{color:var(--muted-dark)}
.btn{
    background:linear-gradient(90deg,var(--accent-red),var(--accent-red-2));color:#fff;padding:10px 12px;border-radius:10px;border:none;cursor:pointer;font-weight:700;
    transition: all 0.2s ease-in-out;
    text-decoration: none;
}
.btn:hover {
    opacity: 0.9;
    transform: translateY(-1px);
    box-shadow: 0 2px 5px rgba(0,0,0,0.2);
}
.btn.ghost{background:transparent;border:1px solid rgba(0,0,0,0.06);color:inherit}
.btn.ghost:hover {
    background: rgba(0,0,0,0.05);
    transform: none;
    box-shadow: none;
}
body.dark .btn.ghost{border:1px solid rgba(255,255,255,0.03)}
body.dark .btn.ghost:hover {
    background: rgba(255,255,255,0.05);
}
.small{font-size:13px;padding:8px}
.actions{display:flex;gap:10px;align-items:center;margin-top:8px}
.sosList{display:flex;flex-direction:column;gap:12px;margin-top:8px}
.sosItem{
    display:flex;
    flex-wrap: wrap;
    gap: 8px;
    align-items: center;
    border: 1px dashed rgba(0,0,0,0.1);
    border-radius: 8px;
    padding: 8px;
    transition: border-color .3s;
}
body.dark .sosItem { border: 1px dashed rgba(255,255,255,0.1); }
.sosItem input, .sosItem select{
    padding:8px;border-radius:8px;
    flex: 1 1 auto;
    box-sizing: border-box;
    min-width: 100px;
}
.sosItem .sosName { flex-basis: 35%; min-width: 120px; }
.sosItem .sosPhone { flex-basis: 35%; min-width: 120px; }
.sosItem .sosRelation { flex-basis: 20%; min-width: 80px; }
.sosItem .removeBtn { flex: 0 0 auto; }
.sosOtherField {
    flex: 1 1 100%;
    margin-top: 4px;
}
@media (max-width: 600px) {
    .sosItem input, .sosItem select { flex: 1 1 100%; min-width: 100%; }
    .sosItem .sosName, .sosItem .sosPhone, .sosItem .sosRelation { flex-basis: 100%; }
}
.removeBtn{background:transparent;border:none;color:var(--accent-red);font-weight:700;cursor:pointer}
.removeBtn:hover { text-decoration: underline; }
.profileCard .header{display:flex;gap:12px;align-items:center}
.pill{
    background:linear-gradient(90deg,var(--accent-red),var(--accent-red-2));color:#fff;padding:6px 10px;border-radius:999px;font-weight:700;
    transition: background 0.3s;
}
.infoList{display:flex;flex-direction:column;gap:8px;margin-top:12px}
.infoItem{
    display:grid;
    grid-template-columns: 120px 1fr;
    padding:10px 12px;
    border-radius:var(--radius);
    background:var(--preview-row-light);
    align-items: start;
    transition: background 0.3s;
}
body.dark .infoItem{background:var(--preview-row-dark)}
.sosPreview{
    display: flex;
    flex-direction: column;
    gap: 8px;
    margin-top: 12px;
}
.sosPreview a{
    display: flex;
    justify-content: space-between;
    align-items: center;
    color:inherit;
    text-decoration:none;
    font-weight:700;
    padding: 4px 0;
    transition: color 0.2s;
}
.sosPreview a:hover {
    color: var(--accent-red);
}
.sosPreview a span.number {
    font-weight: 600;
    color: var(--accent-red);
    transition: color 0.2s;
}
body.dark .sosPreview a span.number {
    color: var(--muted-dark);
}
body.dark .sosPreview a:hover span.number {
    color: var(--accent-red);
}
footer{
    margin-top:18px;
    color:var(--muted-light);
    font-size:13px;
    text-align: center;
}
.modal{
    position:fixed;left:0;top:0;width:100%;height:100%;display:none;align-items:center;justify-content:center;background:rgba(0,0,0,0.65);padding:20px;z-index:9999;
    transition: opacity 0.3s ease-in-out;
    opacity: 0;
}
.modal.show {
    display: flex;
    opacity: 1;
}
.modalCard{width:100%;max-width:700px;max-height: 90vh; overflow-y: auto;}
.linkBtn{background:transparent;border:1px solid rgba(0,0,0,0.06);padding:8px;border-radius:8px;color:var(--accent-red);font-weight:700}
body.dark .linkBtn{border:1px solid rgba(255,255,255,0.03)}
.muted{color:var(--muted-light);font-size:13px}
body.dark .muted{color:var(--muted-dark)}
.video-responsive {
    overflow: hidden;
    padding-bottom: 56.25%;
    position: relative;
    height: 0;
    margin-bottom: 12px;
}
.video-responsive iframe {
    left: 0;
    top: 0;
    height: 100%;
    width: 100%;
    position: absolute;
    border-radius: var(--radius);
}
#firstAidInfo h4 {
    margin-top: 1.2em;
    margin-bottom: 0.5em;
    color: var(--accent-red-2);
}
</style>
</head>
<body>
 <div class="app">
    <main>
      <header>
        <div class="brand">
          <div class="logo" id="logo">MB</div>
          <div>
            <h1 id="brandTitle">MED-BRASLET</h1>
            <div class="subtitle" id="brandSubtitle"></div>
          </div>
        </div>

        <div style="display:flex;gap:8px;align-items:center">
          <select id="langSwitch">
            <option value="uk">–£–∫—Ä–∞—ó–Ω—Å—å–∫–∞ üá∫üá¶</option>
            <option value="en">English üá¨üáß</option>
          </select>
          <button id="themeToggle" class="linkBtn">üåô</button>
        </div>
      </header>

      <section class="card" id="formCard" aria-labelledby="formTitle">
        <h2 id="formTitle"></h2>
        <p class="hint" id="formHint"></p>

        <form id="profileForm" onsubmit="return false;">
          <div><label id="lblName" for="name"></label><input id="name" type="text" /></div>
          <div><label id="lblSurname" for="surname"></label><input id="surname" type="text" /></div>
          <div><label id="lblAge" for="age"></label><input id="age" type="number" min="0" max="120" /></div>
          <div><label id="lblAddress" for="address"></label><input id="address" type="text" /></div>
          <div>
            <label id="lblBlood" for="blood"></label>
            <select id="blood"></select>
          </div>
          <div>
            <label id="lblRh" for="rh"></label>
            <select id="rh"></select>
          </div>

          <div>
            <label id="lblAllergy" for="allergy"></label>
            <div class="hint" id="allergyHint"></div>
            <select id="allergy" multiple=""></select>
            <input id="allergyOther" type="text" style="display:none;margin-top:6px" />
          </div>

          <div>
            <label id="lblDisease" for="disease"></label>
            <div class="hint" id="diseaseHint"></div>
            <select id="disease" multiple=""></select>
            <input id="diseaseOther" type="text" style="display:none;margin-top:6px" />
          </div>

          <div><label id="lblMeds" for="meds"></label><input id="meds" type="text" /></div>

          <div>
            <label id="lblSos" for="sosList"></label>
            <div class="hint" id="sosHint"></div>
            <div id="sosList" class="sosList"></div>
            <div style="margin-top:8px">
              <button id="addContactBtn" type="button" class="btn small"></button>
            </div>
          </div>

          <div>
            <label id="lblPin" for="pin"></label>
            <div class="hint" id="pinHint"></div>
            <input id="pin" type="password" maxlength="8" inputmode="numeric" />
            <div id="pinErr" class="muted" style="color:var(--accent-red);display:none;margin-top:6px" role="alert"></div>
          </div>

          <div class="actions">
            <button id="saveBtn" type="button" class="btn"></button>
            <button id="clearBtn" type="button" class="btn ghost"></button>
          </div>
        </form>
      </section>

    </main>

    <aside class="rightCol">
      <section class="card profileCard" id="profileCard" aria-live="polite">
        <div class="header">
          <div class="avatar" id="avatar">MB</div>
          <div>
            <div id="previewName"></div>
            <div id="previewSub" class="muted"></div>
            <div id="bloodBadge" style="margin-top:8px;display:none" class="pill"></div>
          </div>
        </div>

        <div class="infoList" id="infoList"></div>

        <div style="margin-top:12px">
          <div style="display:flex;gap:8px">
            <button id="sosBtn" class="btn small" style="flex:1">üìû SOS</button>
            <button id="shareBtn" class="btn small ghost" style="flex:1; display: none;"></button>
            <button id="editBtn" class="btn small ghost" style="flex:1"></button>
          </div>
          <div id="sosPreview" class="sosPreview"></div>
        </div>
      </section>

          <div id="shareModal" class="modal" role="dialog" aria-modal="true" aria-labelledby="shareModalTitle">
        <div class="modalCard card">
          <button id="closeShare" style="float:right;border:none;background:transparent;font-size:18px">‚úñ</button>
          <h3 id="shareModalTitle"></h3>
          <p id="shareHint" class="muted" style="margin-top:0"></p>
          <input id="shareLinkInput" type="text" readonly="" style="margin-top:8px; background: var(--input-bg-light);" />
          <button id="copyLinkBtn" class="btn" style="width:100%; margin-top:12px;"></button>
        </div>
      </div>


      <section class="card" id="firstAidCard" style="margin-top:12px; display:none; text-align: center;">
          <button id="openFirstAidModal" class="btn"></button>
          <div style="margin-top:8px" class="muted" id="firstAidHint"></div>
      </section>

      <section class="card" style="margin-top:12px">
        <h3 id="adviceTitle"></h3>
        <ul style="margin:8px 0 0 18px;color:var(--muted-light)" id="adviceList"></ul>
      </section>
    </aside>
 </div>

 <footer id="appFooter"></footer>

  <div id="sosModal" class="modal" role="dialog" aria-modal="true" aria-labelledby="sosModalTitle">
    <div class="modalCard card">
      <button id="closeSos" style="float:right;border:none;background:transparent;font-size:18px">‚úñ</button>
      <h3 id="sosModalTitle"></h3>
      <ul id="sosModalList" style="list-style:none;padding-left:0;margin-top:8px"></ul>
    </div>
 </div>

  <div id="firstAidModal" class="modal" role="dialog" aria-modal="true" aria-labelledby="firstAidModalTitle">
    <div class="modalCard card">
      <button id="closeFirstAid" style="float:right;border:none;background:transparent;font-size:18px">‚úñ</button>
      <h3 id="firstAidModalTitle"></h3>

      <div class="video-responsive">
                      <iframe id="firstAidVideo" width="560" height="315" src="" frameborder="0" allow="accelerometer; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe>
      </div>

      <div id="firstAidInfo"></div>
    </div>
 </div>

<script>
const I18N = {
 uk: {
    pageTitle: 'MED-BRASLET ‚Äî –ú–µ–¥–∏—á–Ω–∏–π –ø—Ä–æ—Ñ—ñ–ª—å',
    brandTitle: 'MED-BRASLET',
    brandSubtitle: '–ú–µ–¥–∏—á–Ω–∏–π –ø—Ä–æ—Ñ—ñ–ª—å ‚Äî —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è, —â–æ —Ä—è—Ç—É—î –∂–∏—Ç—Ç—è.',
    formTitle: '–°—Ç–≤–æ—Ä–∏—Ç–∏ –º–µ–¥–∏—á–Ω–∏–π –ø—Ä–æ—Ñ—ñ–ª—å',
    formHint: '–ü–æ—Ç—Ä—ñ–±–Ω—ñ –¥–∞–Ω—ñ, —è–∫—ñ –¥–æ–ø–æ–º–∞–≥–∞—é—Ç—å —à–≤–∏–¥–∫–æ –Ω–∞–¥–∞—Ç–∏ –¥–æ–ø–æ–º–æ–≥—É. –†–µ–∫–æ–º–µ–Ω–¥—É—î–º–æ –≤—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ –∫–æ–¥ —Ä–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è.',
    addContact: '–î–æ–¥–∞—Ç–∏ –∫–æ–Ω—Ç–∞–∫—Ç',
    save: '–ó–±–µ—Ä–µ–≥—Ç–∏ –ø—Ä–æ—Ñ—ñ–ª—å',
    share: '–ü–æ–¥—ñ–ª–∏—Ç–∏—Å—è',
    shareModalTitle: '–ü–æ–¥—ñ–ª–∏—Ç–∏—Å—è –ø—Ä–æ—Ñ—ñ–ª–µ–º',
    shareHint: '–ë—É–¥—å-—Ö—Ç–æ –∑–º–æ–∂–µ –ø–µ—Ä–µ–≥–ª—è–Ω—É—Ç–∏ –ø—Ä–æ—Ñ—ñ–ª—å, –∞–ª–µ –Ω–µ —Ä–µ–¥–∞–≥—É–≤–∞—Ç–∏.',
    copyLink: '–ö–æ–ø—ñ—é–≤–∞—Ç–∏',
    copiedLink: '–°–∫–æ–ø—ñ–π–æ–≤–∞–Ω–æ! ‚úÖ',
    saved: '–ó–±–µ—Ä–µ–∂–µ–Ω–æ ‚úÖ',
    clear: '–û—á–∏—Å—Ç–∏—Ç–∏',
    edit: '–†–µ–¥–∞–≥—É–≤–∞—Ç–∏',
    firstAidLinkText: '–ü–µ—Ä—à–∞ –º–µ–¥–∏—á–Ω–∞ –¥–æ–ø–æ–º–æ–≥–∞',
    firstAidHint: '–í—ñ–¥–µ–æ-—ñ–Ω—Å—Ç—Ä—É–∫—Ü—ñ—è —Ç–∞ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è',
    firstAidVideoId: 'EfnpLUcALps',
    firstAidModalTitle: '–ü–µ—Ä—à–∞ –º–µ–¥–∏—á–Ω–∞ –¥–æ–ø–æ–º–æ–≥–∞ (–ë–∞–∑–æ–≤–∞ –ø—ñ–¥—Ç—Ä–∏–º–∫–∞ –∂–∏—Ç—Ç—è)',
    firstAidInfo: `
      <h4>–ë–∞–∑–æ–≤–∏–π –∞–ª–≥–æ—Ä–∏—Ç–º –¥—ñ–π (BLS):</h4>
      <ol>
        <li><strong>–û—Ü—ñ–Ω—ñ—Ç—å –±–µ–∑–ø–µ–∫—É.</strong> –ü–µ—Ä–µ–∫–æ–Ω–∞–π—Ç–µ—Å—è, —â–æ –≤–∞–º —Ç–∞ –ø–æ—Å—Ç—Ä–∞–∂–¥–∞–ª–æ–º—É –Ω—ñ—á–æ–≥–æ –Ω–µ –∑–∞–≥—Ä–æ–∂—É—î.</li>
        <li><strong>–ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ —Å–≤—ñ–¥–æ–º—ñ—Å—Ç—å.</strong> –ü–æ—Ç—Ä—É—Å—ñ—Ç—å –∑–∞ –ø–ª–µ—á—ñ —Ç–∞ –≥–æ–ª–æ—Å–Ω–æ –∑–∞–ø–∏—Ç–∞–π—Ç–µ: "–ó –í–∞–º–∏ –≤—Å–µ –≥–∞—Ä–∞–∑–¥?"</li>
        <li><strong>–í–∏–∫–ª–∏—á—Ç–µ –¥–æ–ø–æ–º–æ–≥—É.</strong> –Ø–∫—â–æ –ª—é–¥–∏–Ω–∞ –Ω–µ —Ä–µ–∞–≥—É—î, –Ω–µ–≥–∞–π–Ω–æ —Ç–µ–ª–µ—Ñ–æ–Ω—É–π—Ç–µ **103** –∞–±–æ **112**. –ß—ñ—Ç–∫–æ –ø–æ–≤—ñ–¥–æ–º—Ç–µ –º—ñ—Å—Ü–µ —Ç–∞ —Å–∏—Ç—É–∞—Ü—ñ—é.</li>
        <li><strong>–í—ñ–¥–∫—Ä–∏–π—Ç–µ –¥–∏—Ö–∞–ª—å–Ω—ñ —à–ª—è—Ö–∏.</strong> –ó–∞–∫–∏–Ω—å—Ç–µ –≥–æ–ª–æ–≤—É –Ω–∞–∑–∞–¥ —ñ –ø—ñ–¥–Ω—ñ–º—ñ—Ç—å –ø—ñ–¥–±–æ—Ä—ñ–¥–¥—è, —â–æ–± –∑–∞–±–µ–∑–ø–µ—á–∏—Ç–∏ –ø—Ä–æ—Ö—ñ–¥–Ω—ñ—Å—Ç—å.</li>
        <li><strong>–ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –¥–∏—Ö–∞–Ω–Ω—è.</strong> –ù–∞—Ö–∏–ª—ñ—Ç—å—Å—è —ñ –ø—Ä–æ—Ç—è–≥–æ–º 10 —Å–µ–∫—É–Ω–¥ –ø–æ—Å–ª—É—Ö–∞–π—Ç–µ, –ø–æ–¥–∏–≤—ñ—Ç—å—Å—è —Ç–∞ –≤—ñ–¥—á—É–π—Ç–µ –¥–∏—Ö–∞–Ω–Ω—è.</li>
        <li><strong>–ü–æ—á–Ω—ñ—Ç—å –°–õ–† (–°–µ—Ä—Ü–µ–≤–æ-–ª–µ–≥–µ–Ω–µ–≤–∞ —Ä–µ–∞–Ω—ñ–º–∞—Ü—ñ—è).</strong> –Ø–∫—â–æ –¥–∏—Ö–∞–Ω–Ω—è –≤—ñ–¥—Å—É—Ç–Ω—î –∞–±–æ –Ω–µ–Ω–æ—Ä–º–∞–ª—å–Ω–µ (–∞–≥–æ–Ω–∞–ª—å–Ω–µ), –≤–∏–∫–æ–Ω–∞–π—Ç–µ 30 –Ω–∞—Ç–∏—Å–∫–∞–Ω—å –Ω–∞ –≥—Ä—É–¥–Ω—É –∫–ª—ñ—Ç–∫—É (–ø–æ—Å–µ—Ä–µ–¥–∏–Ω—ñ –≥—Ä—É–¥–µ–π, –≥–ª–∏–±–∏–Ω–∞ 5-6 —Å–º) —Ç–∞, —è–∫—â–æ –Ω–∞–≤—á–µ–Ω—ñ, 2 –≤–¥–∏—Ö–∏ (30:2).</li>
        <li><strong>–ü—Ä–æ–¥–æ–≤–∂—É–π—Ç–µ –°–õ–†</strong> –¥–æ –ø—Ä–∏–±—É—Ç—Ç—è –¥–æ–ø–æ–º–æ–≥–∏ –∞–±–æ –≤—ñ–¥–Ω–æ–≤–ª–µ–Ω–Ω—è –æ–∑–Ω–∞–∫ –∂–∏—Ç—Ç—è.</li>
      </ol>
      <p>–î–∂–µ—Ä–µ–ª–æ: –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—ó –ú–û–ó –£–∫—Ä–∞—ó–Ω–∏ —Ç–∞ –Ñ–≤—Ä–æ–ø–µ–π—Å—å–∫–æ—ó –†–∞–¥–∏ –∑ —Ä–µ–∞–Ω—ñ–º–∞—Ü—ñ—ó (ERC).</p>
    `,
    bloodOptions: ['‚Äî –û–±–µ—Ä—ñ—Ç—å ‚Äî','0 (I)','A (II)','B (III)','AB (IV)'],
    rhOptions: ['‚Äî ‚Äî','+','-'],
    relations: ['–ë–∞—Ç—å–∫–æ','–ú–∞—Ç–∏','–ë—Ä–∞—Ç','–°–µ—Å—Ç—Ä–∞','–î—ñ–¥—É—Å—å','–ë–∞–±—É—Å—è','–î—Ä—É–∂–∏–Ω–∞','–ß–æ–ª–æ–≤—ñ–∫','–õ—ñ–∫–∞—Ä','–Ü–Ω—à–µ'],
    allergyOptions: ['–ü–∏–ª–æ–∫','–ü–∏–ª','–†–∏–±–∞','–ú–æ–ª–æ–∫–æ','–ú–µ–¥–∏–∫–∞–º–µ–Ω—Ç–∏ (–∞–Ω—Ç–∏–±—ñ–æ—Ç–∏–∫–∏)','–£–∫—É—Å –∫–æ–º–∞—Ö','–ì–æ—Ä—ñ—Ö–∏','–Ü–Ω—à–µ'],
    diseaseOptions: ['–î—ñ–∞–±–µ—Ç','–ê—Å—Ç–º–∞','–ì—ñ–ø–µ—Ä—Ç–æ–Ω—ñ—è','–•–≤–æ—Ä–æ–±–∞ —Å–µ—Ä—Ü—è','–ï–ø—ñ–ª–µ–ø—Å—ñ—è','–û–Ω–∫–æ–ª–æ–≥—ñ—á–Ω—ñ','–Ü–Ω—à–µ'],
    noSos: '–ù–µ–º–∞—î –∫–æ–Ω—Ç–∞–∫—Ç—ñ–≤ SOS',
    enterPin: '–í–≤–µ–¥—ñ—Ç—å –∫–æ–¥ —Ä–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è',
    pinWrong: '–ù–µ–≤—ñ—Ä–Ω–∏–π –∫–æ–¥',
    confirmClear: '–í–∏ –≤–ø–µ–≤–Ω–µ–Ω—ñ, —â–æ —Ö–æ—á–µ—Ç–µ –≤–∏–¥–∞–ª–∏—Ç–∏ –ª–æ–∫–∞–ª—å–Ω–∏–π –ø—Ä–æ—Ñ—ñ–ª—å?',
    labelName: "–Ü–º'—è", placeholderName: "–Ü–º'—è",
    labelSurname: '–ü—Ä—ñ–∑–≤–∏—â–µ', placeholderSurname: '–ü—Ä—ñ–∑–≤–∏—â–µ',
    labelAge: '–í—ñ–∫', placeholderAge: '–ù–∞–ø—Ä–∏–∫–ª–∞–¥: 34', ageUnits: '—Ä–æ–∫—ñ–≤',
    labelAddress: '–ê–¥—Ä–µ—Å–∞ (–º—ñ—Å—Ç–æ)', placeholderAddress: '–ú—ñ—Å—Ç–æ, –≤—É–ª–∏—Ü—è',
    labelBlood: '–ì—Ä—É–ø–∞ –∫—Ä–æ–≤—ñ',
    labelRh: 'Rh',
    labelAllergy: '–ê–ª–µ—Ä–≥—ñ—ó', allergyHint: '–í–∏–±–µ—Ä—ñ—Ç—å –æ–¥–Ω—É –∞–±–æ –∫—ñ–ª—å–∫–∞ –æ–ø—Ü—ñ–π (Ctrl/Cmd + –∫–ª—ñ–∫). –Ø–∫—â–æ –≤–∏–±–µ—Ä–µ—Ç–µ ¬´–Ü–Ω—à–µ¬ª, –∑\'—è–≤–∏—Ç—å—Å—è –ø–æ–ª–µ –¥–ª—è –≤–≤–æ–¥—É.', placeholderAllergyOther: '–Ü–Ω—à–µ ‚Äî –≤–ø–∏—à—ñ—Ç—å —Ç—É—Ç',
    labelDisease: '–•—Ä–æ–Ω—ñ—á–Ω—ñ —Ö–≤–æ—Ä–æ–±–∏', diseaseHint: '–í–∏–±–µ—Ä—ñ—Ç—å –æ–¥–Ω—É –∞–±–æ –∫—ñ–ª—å–∫–∞ –æ–ø—Ü—ñ–π (Ctrl/Cmd + –∫–ª—ñ–∫). –Ø–∫—â–æ –≤–∏–±–µ—Ä–µ—Ç–µ ¬´–Ü–Ω—à–µ¬ª, –∑\'—è–≤–∏—Ç—å—Å—è –ø–æ–ª–µ –¥–ª—è –≤–≤–æ–¥—É.', placeholderDiseaseOther: '–Ü–Ω—à–µ ‚Äî –≤–ø–∏—à—ñ—Ç—å —Ç—É—Ç',
    labelMeds: '–ú–µ–¥–∏–∫–∞–º–µ–Ω—Ç–∏', placeholderMeds: '–ü–µ—Ä–µ–ª—ñ–∫ –º–µ–¥–∏–∫–∞–º–µ–Ω—Ç—ñ–≤',
    labelSos: '–ö–æ–Ω—Ç–∞–∫—Ç–∏ SOS', sosHint: '–î–æ–¥–∞–π—Ç–µ 1‚Äì6 –∫–æ–Ω—Ç–∞–∫—Ç—ñ–≤. –î–ª—è –∫–æ–∂–Ω–æ–≥–æ –≤–∫–∞–∂—ñ—Ç—å, –∫–∏–º —î –ª—é–¥–∏–Ω–∞.',
    labelPin: '–ö–æ–¥ –¥–ª—è —Ä–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è (–æ–ø—Ü—ñ–π–Ω–æ)', pinHint: '4‚Äì8 —Ü–∏—Ñ—Ä ‚Äî —Ä–µ–∫–æ–º–µ–Ω–¥—É—î–º–æ, –∞–ª–µ –Ω–µ –æ–±–æ–≤\'—è–∑–∫–æ–≤–æ',
    previewNotCreated: '–ü—Ä–æ—Ñ—ñ–ª—å –Ω–µ —Å—Ç–≤–æ—Ä–µ–Ω–æ', previewSubHint: '–ü—ñ—Å–ª—è –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è —Ç—É—Ç –±—É–¥–µ –ø—É–±–ª—ñ—á–Ω–∏–π –ø—Ä–æ—Ñ—ñ–ª—å',
    previewAddress: '–ê–¥—Ä–µ—Å–∞', previewAllergy: '–ê–ª–µ—Ä–≥—ñ—ó', previewDisease: '–•—Ä–æ–Ω—ñ—á–Ω—ñ —Ö–≤–æ—Ä–æ–±–∏', previewMeds: '–ú–µ–¥–∏–∫–∞–º–µ–Ω—Ç–∏',
    adviceTitle: '–ü–æ—Ä–∞–¥–∏',
    advice1: '–†–µ–∫–æ–º–µ–Ω–¥—É—î–º–æ –≤—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ –∫–æ–¥ –¥–ª—è –∑–∞—Ö–∏—Å—Ç—É —Ä–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è.',
    advice2: '–î–æ–¥–∞–≤–∞–π—Ç–µ –∫–æ–Ω—Ç–∞–∫—Ç –ª—ñ–∫–∞—Ä—è –∞–±–æ –Ω–∞–π–±–ª–∏–∂—á–æ–≥–æ —Ä–æ–¥–∏—á–∞.',
    advice3: '–î—ñ–ª—ñ—Ç—å—Å—è –ø—Ä–æ—Ñ—ñ–ª–µ–º –ª–∏—à–µ —Ç–∏–º, –∫–æ–º—É –¥–æ–≤—ñ—Ä—è—î—Ç–µ.',
    sosModalTitle: '–ö–æ–Ω—Ç–∞–∫—Ç–∏ SOS', sosItemPlaceholderName: "–Ü–º'—è", sosItemPlaceholderPhone: "–¢–µ–ª–µ—Ñ–æ–Ω", sosItemRelation: "–°—Ç–æ—Å—É–Ω–æ–∫", sosItemRemove: "–í–∏–¥–∞–ª–∏—Ç–∏", sosItemPlaceholderOther: "–Ü–Ω—à–µ ‚Äî –≤–ø–∏—à—ñ—Ç—å —Ç—É—Ç",
    alertName: "–í–∫–∞–∂—ñ—Ç—å —ñ–º'—è –∞–±–æ –ø—Ä—ñ–∑–≤–∏—â–µ", alertSos: '–£ –ø—Ä–æ—Ñ—ñ–ª—ñ –Ω–µ–º–∞ SOS –∫–æ–Ω—Ç–∞–∫—Ç—ñ–≤. –ü—Ä–æ–¥–æ–≤–∂–∏—Ç–∏?', alertMaxSos: '–ú–∞–∫—Å–∏–º—É–º 6 –∫–æ–Ω—Ç–∞–∫—Ç—ñ–≤', alertPin: '–ö–æ–¥ –º–∞—î –±—É—Ç–∏ 4‚Äì8 —Ü–∏—Ñ—Ä',
    alertEditShare: '–ë—É–¥—å –ª–∞—Å–∫–∞, –≤–∏–¥–∞–ª—ñ—Ç—å —á–∞—Å—Ç–∏–Ω—É URL –ø—ñ—Å–ª—è –∑–Ω–∞–∫—É "#" (–¥–æ–º–∞—à–Ω—è —Å—Ç–æ—Ä—ñ–Ω–∫–∞), —â–æ–± –ø–æ–≤–µ—Ä–Ω—É—Ç–∏—Å—è –≤ —Ä–µ–∂–∏–º —Ä–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è.',
    creationFooter: '–°—Ç–≤–æ—Ä–µ–Ω–æ –∫–æ–º–ø–∞–Ω—ñ—î—é VITRODUY',
    closeBtnLabel: '–ó–∞–∫—Ä–∏—Ç–∏',
    firstAidVideoTitle: '–í—ñ–¥–µ–æ —ñ–Ω—Å—Ç—Ä—É–∫—Ü—ñ—è –∑ –ø–µ—Ä—à–æ—ó –¥–æ–ø–æ–º–æ–≥–∏',
    langSwitchLabel: '–í–∏–±—ñ—Ä –º–æ–≤–∏',
    themeToggleTitle: '–ü–µ—Ä–µ–º–∫–Ω—É—Ç–∏ —Ç–µ–º—É',
    logoLabel: '–õ–æ–≥–æ—Ç–∏–ø MED-BRASLET',
    avatarLabel: '–ê–≤–∞—Ç–∞—Ä –ø—Ä–æ—Ñ—ñ–ª—é',
    bloodAriaLabel: '–ì—Ä—É–ø–∞ –∫—Ä–æ–≤—ñ',
    rhAriaLabel: '–†–µ–∑—É—Å-—Ñ–∞–∫—Ç–æ—Ä',
    allergyAriaLabel: '–°–ø–∏—Å–æ–∫ –∞–ª–µ—Ä–≥—ñ–π',
    diseaseAriaLabel: '–°–ø–∏—Å–æ–∫ —Ö—Ä–æ–Ω—ñ—á–Ω–∏—Ö —Ö–≤–æ—Ä–æ–±',
    allergyOtherAriaLabel: '–í–≤–µ—Å—Ç–∏ —ñ–Ω—à—É –∞–ª–µ—Ä–≥—ñ—é',
    diseaseOtherAriaLabel: '–í–≤–µ—Å—Ç–∏ —ñ–Ω—à—É —Ö–≤–æ—Ä–æ–±—É',
    addContactBtnAriaLabel: '–î–æ–¥–∞—Ç–∏ –Ω–æ–≤–∏–π SOS –∫–æ–Ω—Ç–∞–∫—Ç',
    saveBtnAriaLabel: '–ó–±–µ—Ä–µ–≥—Ç–∏ –º–µ–¥–∏—á–Ω–∏–π –ø—Ä–æ—Ñ—ñ–ª—å',
    clearBtnAriaLabel: '–û—á–∏—Å—Ç–∏—Ç–∏ –ø—Ä–æ—Ñ—ñ–ª—å',
    sosBtnAriaLabel: '–ü–æ–∫–∞–∑–∞—Ç–∏ SOS –∫–æ–Ω—Ç–∞–∫—Ç–∏',
    shareBtnAriaLabel: '–ü–æ–¥—ñ–ª–∏—Ç–∏—Å—è –ø—Ä–æ—Ñ—ñ–ª–µ–º',
    editBtnAriaLabel: '–†–µ–¥–∞–≥—É–≤–∞—Ç–∏ –ø—Ä–æ—Ñ—ñ–ª—å',
    firstAidBtnAriaLabel: '–í—ñ–¥–∫—Ä–∏—Ç–∏ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –ø—Ä–æ –ø–µ—Ä—à—É –º–µ–¥–∏—á–Ω—É –¥–æ–ø–æ–º–æ–≥—É',
    removeContactBtnAriaLabel: '–í–∏–¥–∞–ª–∏—Ç–∏ –∫–æ–Ω—Ç–∞–∫—Ç',
    sosContactAriaLabel: '–ö–æ–Ω—Ç–∞–∫—Ç: %s',
 },
 en: {
    pageTitle: 'MED-BRASLET ‚Äî Medical Profile',
    brandTitle: 'MED-BRASLET',
    brandSubtitle: 'Medical profile ‚Äî information that saves lives.',
    formTitle: 'Create medical profile',
    formHint: 'Fill only what you are comfortable sharing. We recommend an edit PIN for protection.',
    addContact: 'Add contact',
    save: 'Save profile',
    saved: 'Saved ‚úÖ',
    clear: 'Clear',
    edit: 'Edit',
    share: 'Share',
    shareModalTitle: 'Share Profile',
    shareHint: 'Everyone can view the profile, but not edit it.',
    copyLink: 'Copy Link',
    copiedLink: 'Copied! ‚úÖ',
    firstAidLinkText: 'First Medical Aid',
    firstAidHint: 'Video instruction and information',
    firstAidVideoId: 'I-p_YnvOs-0',
    firstAidModalTitle: 'First Medical Aid (Basic Life Support)',
    firstAidInfo: `
      <h4>Basic Life Support Algorithm:</h4>
      <ol>
        <li><strong>Check for danger.</strong> Ensure the area is safe for you and the casualty.</li>
        <li><strong>Check for response.</strong> Shake the shoulders gently and ask loudly, "Are you alright?"</li>
        <li><strong>Call for help.</strong> If there is no response, call **911** or your local emergency number immediately. Provide clear location and situation details.</li>
        <li><strong>Open the airway.</strong> Tilt the head back and lift the chin to open the airway.</li>
        <li><strong>Check for breathing.</strong> Look, listen, and feel for normal breathing for no more than 10 seconds.</li>
        <li><strong>Start CPR (Cardiopulmonary Resuscitation).</strong> If breathing is absent or abnormal (agonal), start with 30 chest compressions (center of the chest, depth 5-6 cm) and, if trained, follow with 2 rescue breaths (30:2).</li>
        <li><strong>Continue CPR</strong> until professional help arrives or the casualty shows signs of recovery.</li>
      </ol>
      <p>Source: European Resuscitation Council (ERC) Guidelines.</p>
    `,
    bloodOptions: ['‚Äî Select ‚Äî','0 (I)','A (II)','B (III)','AB (IV)'],
    rhOptions: ['‚Äî ‚Äî','+','-'],
    relations: ['Father','Mother','Brother','Sister','Grandpa','Grandma','Wife','Husband','Doctor','Other'],
    allergyOptions: ['Pollen','Dust','Fish','Milk','Medications (antibiotics)','Insect sting','Nuts','Other'],
    diseaseOptions: ['Diabetes','Astma','Hypertension','Heart disease','Epilepsy','Oncological','Other'],
    noSos: 'No SOS contacts',
    enterPin: 'Enter edit PIN',
    pinWrong: 'Wrong PIN',
    confirmClear: 'Are you sure you want to delete the local profile?',
    labelName: 'Name', placeholderName: 'Name',
    labelSurname: 'Surname', placeholderSurname: 'Surname',
    labelAge: 'Age', placeholderAge: 'E.g.: 34', ageUnits: 'y.o.',
    labelAddress: 'Address (city)', placeholderAddress: 'City, street',
    labelBlood: 'Blood group',
    labelRh: 'Rh',
    labelAllergy: 'Allergies', allergyHint: 'Select one or more options (Ctrl/Cmd + click). If you select "Other", an input field will appear.', placeholderAllergyOther: 'Other ‚Äî enter here',
    labelDisease: 'Chronic diseases', diseaseHint: 'Select one or more options (Ctrl/Cmd + click). If you select "Other", an input field will appear.', placeholderDiseaseOther: 'Other ‚Äî enter here',
    labelMeds: 'Medications', placeholderMeds: 'List of medications',
    labelSos: 'SOS contacts', sosHint: 'Add 1‚Äì6 contacts. For each, specify the relation.',
    labelPin: 'Edit PIN (optional)', pinHint: '4‚Äì8 digits ‚Äî optional but recommended',
    previewNotCreated: 'Profile not created', previewSubHint: 'Your public profile will appear here after saving',
    previewAddress: 'Address', previewAllergy: 'Allergies', previewDisease: 'Chronic diseases', previewMeds: 'Medications',
    adviceTitle: 'Advice',
    advice1: 'We recommend setting a PIN to protect editing.',
    advice2: 'Add the contact of a doctor or closest relative.',
    advice3: 'Share the profile only with those you trust.',
    sosModalTitle: 'SOS Contacts', sosItemPlaceholderName: "Name", sosItemPlaceholderPhone: "Phone", sosItemRelation: "Relation", sosItemRemove: "Remove", sosItemPlaceholderOther: "Other ‚Äî enter here",
    alertName: "Please enter name or surname", alertSos: 'No SOS contacts. Continue?', alertMaxSos: 'Max 6 contacts', alertPin: 'PIN must be 4‚Äì8 digits',
    alertEditShare: 'Please remove the part of the URL after the "#" sign (homepage) to return to editing mode.',
    creationFooter: 'Created with the help of VITRODUY company',
    closeBtnLabel: 'Close',
    firstAidVideoTitle: 'First aid video instruction',
    langSwitchLabel: 'Language switch',
    themeToggleTitle: 'Toggle theme',
    logoLabel: 'MED-BRASLET logo',
    avatarLabel: 'Profile avatar',
    bloodAriaLabel: 'Blood group',
    rhAriaLabel: 'Rh factor',
    allergyAriaLabel: 'List of allergies',
    diseaseAriaLabel: 'List of chronic diseases',
    allergyOtherAriaLabel: 'Enter other allergy',
    diseaseOtherAriaLabel: 'Enter other disease',
    addContactBtnAriaLabel: 'Add new SOS contact',
    saveBtnAriaLabel: 'Save medical profile',
    clearBtnAriaLabel: 'Clear profile',
    sosBtnAriaLabel: 'Show SOS contacts',
    shareBtnAriaLabel: 'Share profile',
    editBtnAriaLabel: 'Edit profile',
    firstAidBtnAriaLabel: 'Open first medical aid information',
    removeContactBtnAriaLabel: 'Remove contact',
    sosContactAriaLabel: 'Contact: %s',
 }
};
const PROFILE_KEY = 'med_braslet_profile_v2';
const PIN_KEY = 'med_braslet_pin_v2';
let lang = localStorage.getItem('mb_lang') || (navigator.language && navigator.language.startsWith('en') ? 'en' : 'uk');
let theme = localStorage.getItem('mb_theme') || 'dark';
const el = id => document.getElementById(id);
const qsa = sel => Array.from(document.querySelectorAll(sel));
function b64EncodeUnicode(str){ return btoa(encodeURIComponent(str).replace(/%([0-9A-F]{2})/g,(m,p)=>String.fromCharCode('0x'+p))); }
function b64DecodeUnicode(str){ return decodeURIComponent(Array.prototype.map.call(atob(str), c => '%' + ('00' + c.charCodeAt(0).toString(16)).slice(-2)).join('')); }
function escapeHtml(s){ return s ? String(s).replaceAll('<','&lt;').replaceAll('>','&gt;').replaceAll('&','&amp;').replaceAll('"','&quot;').replaceAll("'",'&#39;') : ''; }
function populateSelect(selectEl, optionsArray, initialValue){
 selectEl.innerHTML = '';
 optionsArray.forEach((opt, idx) => {
    const o=document.createElement('option');
    o.value = idx === 0 ? '' : opt;
    o.textContent = opt;
    selectEl.appendChild(o);
 });
 if(initialValue) selectEl.value = initialValue;
}
function repopulateSelectMultiple(selectEl, optionsArray, currentValues){
    selectEl.innerHTML = optionsArray.map(opt => `<option value="${escapeHtml(opt)}">${escapeHtml(opt)}</option>`).join('');
    const sanitizedValues = (currentValues || []).map(escapeHtml);
    qsa(`#${selectEl.id} option`).forEach(o => {
        if (sanitizedValues.includes(o.value) || sanitizedValues.includes(o.textContent)) {
            o.selected = true;
        }
    });
    selectEl.dispatchEvent(new Event('change'));
}
function getSelectedValues(selectEl){
 return Array.from(selectEl.selectedOptions).map(o=>o.value).filter(v => v !== '');
}
const nameEl = el('name'), surnameEl = el('surname'), ageEl = el('age'), addressEl = el('address');
const bloodEl = el('blood'), rhEl = el('rh'), allergyEl = el('allergy'), allergyOtherEl = el('allergyOther');
const diseaseEl = el('disease'), diseaseOtherEl = el('diseaseOther'), medsEl = el('meds');
const sosListEl = el('sosList'), addContactBtn = el('addContactBtn');
const pinEl = el('pin'), pinErrEl = el('pinErr');
const saveBtn = el('saveBtn'), clearBtn = el('clearBtn');
const editBtn = el('editBtn');
const appFooter = el('appFooter');
const formCard = el('formCard');
const themeToggle = el('themeToggle');
const langSwitch = el('langSwitch');
const sosModal = el('sosModal'), closeSos = el('closeSos'), sosModalList = el('sosModalList');
const firstAidModal = el('firstAidModal'), closeFirstAid = el('closeFirstAid'), firstAidVideo = el('firstAidVideo');
const shareBtn = el('shareBtn'), shareModal = el('shareModal'), closeShare = el('closeShare'), copyLinkBtn = el('copyLinkBtn');
function updateFooter(isProfileSaved){
    const L = I18N[lang];
    if(appFooter) appFooter.textContent = isProfileSaved ? L.creationFooter : '';
}
function createSosItem(data = {name:'', phone:'', relation:'', relationOther:''}){
 const L = I18N[lang];
 const div = document.createElement('div'); div.className='sosItem';
 const options = L.relations.map(r=>`<option value="${escapeHtml(r)}">${escapeHtml(r)}</option>`).join('');
 const labelId = `sos-relation-${Date.now()}-${Math.random().toString(36).substring(2, 9)}`;
 div.innerHTML = `
    <input class="sosName" type="text" placeholder="${L.sosItemPlaceholderName}" value="${escapeHtml(data.name)}" aria-label="${L.sosItemPlaceholderName}">
    <input class="sosPhone" type="tel" placeholder="${L.sosItemPlaceholderPhone}" value="${escapeHtml(data.phone)}" aria-label="${L.sosItemPlaceholderPhone}">
    <select class="sosRelation" id="${labelId}" aria-label="${L.sosItemRelation}">${'<option value="">'+L.sosItemRelation+'</option>' + options}</select>
    <button class="removeBtn" title="${L.sosItemRemove}" aria-label="${L.removeContactBtnAriaLabel}">‚úñ</button>
    <input type="text" class="sosRelationOther sosOtherField" placeholder="${L.sosItemPlaceholderOther}" value="${escapeHtml(data.relationOther)}" style="display:none;" aria-label="${L.sosItemPlaceholderOther}">
 `;
 const selectEl = div.querySelector('.sosRelation');
 if(data.relation) {
    selectEl.value = escapeHtml(data.relation);
    if(selectEl.value !== escapeHtml(data.relation) && data.relation !== '') {
        const option = Array.from(selectEl.options).find(o => o.textContent === data.relation);
        if(option) selectEl.value = option.value;
    }
 }
 const otherEl = div.querySelector('.sosRelationOther');
 const lastOption = L.relations.slice(-1)[0];
 if (selectEl.value === escapeHtml(lastOption) && selectEl.value !== '') {
    otherEl.style.display = 'block';
 } else if (data.relationOther) {
    selectEl.value = escapeHtml(lastOption);
    otherEl.style.display = 'block';
 }
 selectEl.addEventListener('change', () => {
    otherEl.style.display = (selectEl.value === escapeHtml(lastOption) && selectEl.value !== '') ? 'block' : 'none';
    if(otherEl.style.display === 'none') otherEl.value = '';
 });
 div.querySelector('.removeBtn').addEventListener('click', ()=> div.remove());
 return div;
}
function collectProfileFromForm(){
 const L = I18N[lang];
 const lastAllergy = L.allergyOptions.slice(-1)[0];
 const lastDisease = L.diseaseOptions.slice(-1)[0];
 const lastRelation = L.relations.slice(-1)[0];
 const selectedAllergies = getSelectedValues(allergyEl);
 const selectedDiseases = getSelectedValues(diseaseEl);
 const profile = {
    name: nameEl.value.trim(),
    surname: surnameEl.value.trim(),
    age: ageEl.value ? Number(ageEl.value) : null,
    address: addressEl.value.trim(),
    blood: bloodEl.value,
    rh: rhEl.value,
    allergy: selectedAllergies,
    allergyOther: (selectedAllergies.includes(lastAllergy) && allergyOtherEl.value.trim()) ? allergyOtherEl.value.trim() : '',
    disease: selectedDiseases,
    diseaseOther: (selectedDiseases.includes(lastDisease) && diseaseOtherEl.value.trim()) ? diseaseOtherEl.value.trim() : '',
    meds: medsEl.value.trim(),
    sos: []
 };
 qsa('.sosItem').forEach(si=>{
    const name = si.querySelector('.sosName').value.trim();
    const phone = si.querySelector('.sosPhone').value.trim();
    const relation = si.querySelector('.sosRelation').value;
    let relationOther = '';
    if (relation === lastRelation) {
        const otherInput = si.querySelector('.sosRelationOther');
        if (otherInput) relationOther = otherInput.value.trim();
    }
    if(name && phone) profile.sos.push({name, phone, relation, relationOther});
 });
 return profile;
}
function applyLanguage(){
 localStorage.setItem('mb_lang', lang);
 const L = I18N[lang];
 const currentProfile = collectProfileFromForm();
 const isFormVisible = formCard.style.display !== 'none' && !formCard.classList.contains('hidden');

 document.title = L.pageTitle;

 qsa('[id]').forEach(element => {
       const id = element.id;
       if (L[id]) element.textContent = L[id];
       if (L['lbl' + id.charAt(0).toUpperCase() + id.slice(1)]) {
           el('lbl' + id.charAt(0).toUpperCase() + id.slice(1)).textContent = L['lbl' + id.charAt(0).toUpperCase() + id.slice(1)];
       }
       if (L['placeholder' + id.charAt(0).toUpperCase() + id.slice(1)] && element.placeholder !== undefined) {
           element.placeholder = L['placeholder' + id.charAt(0).toUpperCase() + id.slice(1)];
       }
 });

 // Set content for elements without a direct I18N key mapping
 el('brandSubtitle').textContent = L.brandSubtitle;
 el('allergyHint').textContent = L.allergyHint;
 el('diseaseHint').textContent = L.diseaseHint;
 el('sosHint').textContent = L.sosHint;
 el('pinHint').textContent = L.pinHint;
 el('firstAidHint').textContent = L.firstAidHint;
 el('firstAidModalTitle').textContent = L.firstAidModalTitle;
 el('firstAidInfo').innerHTML = L.firstAidInfo;
 el('shareModalTitle').textContent = L.shareModalTitle;
 el('shareHint').textContent = L.shareHint;
 el('copyLinkBtn').textContent = L.copyLink;
 addContactBtn.textContent = '‚ûï ' + L.addContact;
 saveBtn.textContent = 'üíæ ' + L.save;
 clearBtn.textContent = 'üóë ' + L.clear;
 editBtn.textContent = '‚úèÔ∏è ' + L.edit;
 shareBtn.textContent = 'üîó ' + L.share;
 el('openFirstAidModal').textContent = L.firstAidLinkText;
 el('sosModalTitle').textContent = L.sosModalTitle;

 // Set ARIA labels and titles
 el('logo').setAttribute('aria-label', L.logoLabel);
 el('avatar').setAttribute('aria-label', L.avatarLabel);
 el('langSwitch').setAttribute('aria-label', L.langSwitchLabel);
 themeToggle.setAttribute('title', L.themeToggleTitle);
 themeToggle.setAttribute('aria-label', L.themeToggleTitle);
 el('blood').setAttribute('aria-label', L.bloodAriaLabel);
 el('rh').setAttribute('aria-label', L.rhAriaLabel);
 el('allergy').setAttribute('aria-label', L.allergyAriaLabel);
 el('disease').setAttribute('aria-label', L.diseaseAriaLabel);
 allergyOtherEl.setAttribute('aria-label', L.allergyOtherAriaLabel);
 diseaseOtherEl.setAttribute('aria-label', L.diseaseOtherAriaLabel);
 addContactBtn.setAttribute('aria-label', L.addContactBtnAriaLabel);
 saveBtn.setAttribute('aria-label', L.saveBtnAriaLabel);
 clearBtn.setAttribute('aria-label', L.clearBtnAriaLabel);
 sosBtn.setAttribute('aria-label', L.sosBtnAriaLabel);
 shareBtn.setAttribute('aria-label', L.shareBtnAriaLabel);
 editBtn.setAttribute('aria-label', L.editBtnAriaLabel);
 openFirstAidModal.setAttribute('aria-label', L.firstAidBtnAriaLabel);
 closeShare.setAttribute('aria-label', L.closeBtnLabel);
 closeSos.setAttribute('aria-label', L.closeBtnLabel);
 closeFirstAid.setAttribute('aria-label', L.closeBtnLabel);
 firstAidVideo.setAttribute('title', L.firstAidVideoTitle);

 // Repopulate dynamic content
 populateSelect(bloodEl, L.bloodOptions, currentProfile.blood);
 populateSelect(rhEl, L.rhOptions, currentProfile.rh);
 repopulateSelectMultiple(allergyEl, L.allergyOptions, currentProfile.allergy);
 repopulateSelectMultiple(diseaseEl, L.diseaseOptions, currentProfile.disease);
 setupOtherToggles();
 nameEl.value = currentProfile.name; surnameEl.value = currentProfile.surname;
 ageEl.value = currentProfile.age; addressEl.value = currentProfile.address;
 medsEl.value = currentProfile.meds; pinEl.value = localStorage.getItem(PIN_KEY) || '';
 allergyOtherEl.value = currentProfile.allergyOther; diseaseOtherEl.value = currentProfile.diseaseOther;
 sosListEl.innerHTML = '';
 if (currentProfile.sos && currentProfile.sos.length > 0) {
    (currentProfile.sos || []).forEach(c => sosListEl.appendChild(createSosItem(c)));
 } else {
    sosListEl.appendChild(createSosItem());
 }
 el('adviceList').innerHTML = `
    <li>${L.advice1}</li>
    <li>${L.advice2}</li>
    <li>${L.advice3}</li>
 `;
 updateProfileDisplay();
 if(isFormVisible) {
       formCard.style.display = 'block';
       formCard.classList.remove('hidden');
 } else {
       formCard.classList.add('hidden');
       formCard.style.display = 'none';
 }
}
function applyTheme(){
 localStorage.setItem('mb_theme', theme);
 if(theme === 'dark') document.body.classList.add('dark'); else document.body.classList.remove('dark');
 el('themeToggle').textContent = theme === 'dark' ? '‚òÄÔ∏è' : 'üåô';
}
function showPublicProfile(profile, readonly=false){
 const L = I18N[lang];
 if(!profile || !profile.name && !profile.surname && !profile.age){
       el('previewName').textContent = L.previewNotCreated;
       el('previewSub').textContent = L.previewSubHint;
       el('avatar').textContent = 'MB';
       el('bloodBadge').style.display = 'none';
       el('infoList').innerHTML = '';
       el('sosPreview').innerHTML = `<div class="muted">${L.noSos}</div>`;
       el('editBtn').style.display = 'none';
       el('shareBtn').style.display = 'none';
       el('firstAidCard').style.display = 'block';
       updateFooter(false);
       return;
 }
 const fullName = `${profile.name || ''} ${profile.surname || ''}`.trim();
 el('previewName').textContent = escapeHtml(fullName);
 el('previewSub').textContent = profile.age ? `${profile.age} ${L.ageUnits}` : L.previewSubHint;
 el('avatar').textContent = ((profile.name||'').charAt(0)||'').toUpperCase() + ((profile.surname||'').charAt(0)||'').toUpperCase();
 if(profile.blood){ el('bloodBadge').style.display='inline-block'; el('bloodBadge').textContent = `${escapeHtml(profile.blood)}${profile.rh ? ' ‚Ä¢ ' + escapeHtml(profile.rh) : ''}`; } else el('bloodBadge').style.display='none';
 el('infoList').innerHTML = '';
 const lastAllergy = L.allergyOptions.slice(-1)[0];
 const lastDisease = L.diseaseOptions.slice(-1)[0];
 const lastRelation = L.relations.slice(-1)[0];
 const allergiesDisplay = (profile.allergy || [])
    .filter(v => !(v === lastAllergy && profile.allergyOther))
    .concat(profile.allergyOther ? profile.allergyOther : [])
    .filter(Boolean)
    .join(', ');
 const diseasesDisplay = (profile.disease || [])
    .filter(v => !(v === lastDisease && profile.diseaseOther))
    .concat(profile.diseaseOther ? profile.diseaseOther : [])
    .filter(Boolean)
    .join(', ');
 const infoRows = [
    {k: L.previewAddress, v: profile.address},
    {k: L.previewAllergy, v: allergiesDisplay},
    {k: L.previewDisease, v: diseasesDisplay},
    {k: L.previewMeds, v: profile.meds}
 ];
 infoRows.forEach(r=>{
    if(r.v){
      const d = document.createElement('div'); d.className='infoItem';
      d.innerHTML = `<div>${escapeHtml(r.k)}</div><div>${escapeHtml(String(r.v))}</div>`;
      el('infoList').appendChild(d);
    }
 });
 el('sosPreview').innerHTML = '';
 if(profile.sos && profile.sos.length){
    profile.sos.forEach(c=>{
      const a = document.createElement('a');
      a.href = 'tel:' + encodeURIComponent(c.phone);
      let relationDisplay = c.relation;
      if (c.relation === lastRelation && c.relationOther) {
          relationDisplay = c.relationOther;
      } else if (!c.relation) {
          relationDisplay = '';
      }
      const nameText = `${c.name}${relationDisplay ? ' (' + relationDisplay + ')' : ''}`;
      const ariaLabel = L.sosContactAriaLabel.replace('%s', escapeHtml(c.name));
      a.innerHTML = `<span aria-label="${ariaLabel}">${escapeHtml(nameText)}</span><span class="number">${escapeHtml(c.phone)}</span>`;
      el('sosPreview').appendChild(a);
    });
 } else {
    const p = document.createElement('div'); p.className='muted'; p.textContent = L.noSos; el('sosPreview').appendChild(p);
 }
 el('editBtn').style.display = readonly ? 'none' : 'inline-block';
 el('shareBtn').style.display = 'inline-block';
 el('firstAidCard').style.display = 'block';
 updateFooter(true);
}
function updateProfileDisplay(){
    const raw = localStorage.getItem(PROFILE_KEY);
    const profile = raw ? JSON.parse(raw) : null;
    if(location.hash && location.hash.startsWith('#profile=')){
        try{
            const decoded = b64DecodeUnicode(location.hash.replace('#profile=',''));
            const hashProfile = JSON.parse(decoded);
            formCard.classList.add('hidden');
            formCard.style.display = 'none';
            showPublicProfile(hashProfile, true);
            return;
        } catch(e) { }
    }
    if (profile) {
        showPublicProfile(profile, false);
    } else {
        showPublicProfile(null, false);
    }
}
function saveProfile(){
 const L = I18N[lang];
 const profile = collectProfileFromForm();
 if(!profile.name && !profile.surname){ alert(L.alertName); return; }
 if(!profile.sos || profile.sos.length === 0){ if(!confirm(L.alertSos)) return; }
 const pinVal = pinEl.value.trim();
 if(pinVal && !/^\d{4,8}$/i.test(pinVal)){ pinErrEl.style.display='block'; pinErrEl.textContent = L.alertPin; return; }
 pinErrEl.style.display='none';
 if(pinVal) localStorage.setItem(PIN_KEY, pinVal);
 else localStorage.removeItem(PIN_KEY);
 localStorage.setItem(PROFILE_KEY, JSON.stringify(profile));
 updateProfileDisplay();
 formCard.classList.add('hidden');
 setTimeout(() => formCard.style.display = 'none', 500);
 saveBtn.textContent = L.saved;
 setTimeout(()=> saveBtn.textContent = 'üíæ ' + L.save, 1400);
}
function clearProfile(){
 const L = I18N[lang];
 if(!confirm(L.confirmClear)) return;
 localStorage.removeItem(PROFILE_KEY);
 localStorage.removeItem(PIN_KEY);
 resetForm();
 updateProfileDisplay();
 formCard.style.display = 'block';
 setTimeout(() => formCard.classList.remove('hidden'), 10);
}
function resetForm(){
 [nameEl,surnameEl,ageEl,addressEl,medsEl,pinEl].forEach(i=>i.value='');
 if(bloodEl.options.length > 0) bloodEl.selectedIndex = 0;
 if(rhEl.options.length > 0) rhEl.selectedIndex = 0;
 qsa('#allergy option').forEach(o=>o.selected=false); allergyOtherEl.value = ''; allergyOtherEl.style.display = 'none';
 qsa('#disease option').forEach(o=>o.selected=false); diseaseOtherEl.value = ''; diseaseOtherEl.style.display = 'none';
 sosListEl.innerHTML = '';
 sosListEl.appendChild(createSosItem());
 setupOtherToggles();
}
function requestEdit(checkPin = true){
 const L = I18N[lang];
 if(location.hash && location.hash.startsWith('#profile=')){
      alert(L.alertEditShare);
      history.replaceState(null, null, window.location.pathname + window.location.search);
      updateProfileDisplay();
      return;
 }
 const storedPin = localStorage.getItem(PIN_KEY);
 const raw = localStorage.getItem(PROFILE_KEY);
 let profile = raw ? JSON.parse(raw) : null;
 if(checkPin && storedPin){
    const entered = prompt(L.enterPin);
    if(entered === null) return;
    if(entered !== storedPin){ alert(L.pinWrong); return; }
 }
 if(!profile) {
    profile = collectProfileFromForm();
 }
 nameEl.value = profile.name || ''; surnameEl.value = profile.surname || '';
 ageEl.value = profile.age || ''; addressEl.value = profile.address || '';
 medsEl.value = profile.meds || ''; pinEl.value = storedPin || '';
 bloodEl.value = profile.blood || ''; rhEl.value = profile.rh || '';
 allergyOtherEl.value = profile.allergyOther || '';
 diseaseOtherEl.value = profile.diseaseOther || '';
 sosListEl.innerHTML = '';
 (profile.sos || []).forEach(c => sosListEl.appendChild(createSosItem(c)));
 if((profile.sos || []).length === 0) sosListEl.appendChild(createSosItem());
 repopulateSelectMultiple(allergyEl, L.allergyOptions, profile.allergy || []);
 repopulateSelectMultiple(diseaseEl, L.diseaseOptions, profile.disease || []);
 setupOtherToggles();
 formCard.style.display = 'block';
 setTimeout(() => formCard.classList.remove('hidden'), 10);
}
function setupOtherToggles(){
 const checkOther = (selectEl, otherEl, optionsList) => {
    const lastOption = optionsList.slice(-1)[0];
    const isOtherSelected = Array.from(selectEl.selectedOptions).some(o => o.value === lastOption || o.textContent === lastOption);
    otherEl.style.display = isOtherSelected ? 'block' : 'none';
 };
 function allergyChangeListener(){
       const otherBefore = allergyOtherEl.style.display === 'block';
       checkOther(allergyEl, allergyOtherEl, I18N[lang].allergyOptions);
       if(otherBefore && allergyOtherEl.style.display === 'none') allergyOtherEl.value = '';
 }
 allergyEl.removeEventListener('change', allergyChangeListener);
 allergyEl.addEventListener('change', allergyChangeListener);
 function diseaseChangeListener(){
       const otherBefore = diseaseOtherEl.style.display === 'block';
       checkOther(diseaseEl, diseaseOtherEl, I18N[lang].diseaseOptions);
       if(otherBefore && diseaseOtherEl.style.display === 'none') diseaseOtherEl.value = '';
 }
 diseaseEl.removeEventListener('change', diseaseChangeListener);
 diseaseEl.addEventListener('change', diseaseChangeListener);
 allergyEl.dispatchEvent(new Event('change'));
 diseaseEl.dispatchEvent(new Event('change'));
}
function openModal(modalEl) {
    modalEl.style.display = 'flex';
    setTimeout(() => modalEl.classList.add('show'), 10);
    modalEl.setAttribute('aria-hidden', 'false');
}
function closeModal(modalEl) {
    modalEl.classList.remove('show');
    setTimeout(() => modalEl.style.display = 'none', 300);
    modalEl.setAttribute('aria-hidden', 'true');
}
function openSosModal(){
    const L = I18N[lang];
    let profile = null;
    if(location.hash && location.hash.startsWith('#profile=')){
        try{ profile = JSON.parse(b64DecodeUnicode(location.hash.replace('#profile=',''))); } catch(e) { }
    } else {
        profile = localStorage.getItem(PROFILE_KEY) ? JSON.parse(localStorage.getItem(PROFILE_KEY)) : null;
    }
    sosModalList.innerHTML = '';
    const lastRelation = L.relations.slice(-1)[0];
    if(!profile || !profile.sos || profile.sos.length === 0){
        const li = document.createElement('li'); li.textContent = L.noSos; sosModalList.appendChild(li);
    } else {
        profile.sos.forEach(c=>{
            const li = document.createElement('li');
            const a = document.createElement('a');
            a.href = 'tel:' + encodeURIComponent(c.phone);
            let relationDisplay = c.relation;
            if (c.relation === lastRelation && c.relationOther) {
                relationDisplay = c.relationOther;
            } else if (!c.relation) {
                relationDisplay = '';
            }
            const relationText = relationDisplay ? ` (${escapeHtml(relationDisplay)})` : '';
            a.textContent = `${escapeHtml(c.name)}${relationText} ‚Äî ${escapeHtml(c.phone)}`;
            a.style.display='block'; a.style.padding='8px 0'; a.style.color='inherit'; a.style.textDecoration='none';
            a.style.fontWeight = 'bold';
            li.appendChild(a); sosModalList.appendChild(li);
        });
    }
    openModal(sosModal);
}
function generateAndShowShareLink() {
    const L = I18N[lang];
    const rawProfile = localStorage.getItem(PROFILE_KEY);
    if (!rawProfile) return;
    const encodedProfile = b64EncodeUnicode(rawProfile);
    const shareUrl = `${window.location.origin}${window.location.pathname}#profile=${encodedProfile}`;
    el('shareLinkInput').value = shareUrl;
    el('copyLinkBtn').textContent = L.copyLink;
    openModal(shareModal);
}
function closeSosModal(){ closeModal(sosModal); }
function openFirstAid(){
    const videoId = I18N[lang].firstAidVideoId;
    firstAidVideo.src = `https://www.youtube.com/embed/${videoId}?rel=0`;
    openModal(firstAidModal);
}
function closeFirstAidModal(){
    firstAidVideo.src = '';
    closeModal(firstAidModal);
}
langSwitch.value = lang;
langSwitch.addEventListener('change', (e)=> {
 lang = e.target.value;
 applyLanguage();
});
closeShare.addEventListener('click', () => closeModal(shareModal));
copyLinkBtn.addEventListener('click', function() {
    const linkInput = el('shareLinkInput');
    linkInput.select();
    if (navigator.clipboard && navigator.clipboard.writeText) {
        navigator.clipboard.writeText(linkInput.value).then(() => {
            const L = I18N[lang];
            this.textContent = L.copiedLink;
            setTimeout(() => { this.textContent = L.copyLink; }, 2000);
        });
    } else {
        document.execCommand('copy');
        const L = I18N[lang];
        this.textContent = L.copiedLink;
        setTimeout(() => { this.textContent = L.copyLink; }, 2000);
    }
});
window.addEventListener('click', (e)=> {
      if(e.target === sosModal){ closeSosModal(); }
      if(e.target === firstAidModal){ closeFirstAidModal(); }
      if(e.target === shareModal){ closeModal(shareModal); }
});
themeToggle.addEventListener('click', ()=> {
 theme = (theme==='dark' ? 'light' : 'dark');
 applyTheme();
});
addContactBtn.addEventListener('click', ()=> {
 if(document.querySelectorAll('.sosItem').length >= 6){ alert(I18N[lang].alertMaxSos); return; }
 sosListEl.appendChild(createSosItem());
});
saveBtn.addEventListener('click', saveProfile);
clearBtn.addEventListener('click', clearProfile);
el('editBtn').addEventListener('click', () => requestEdit(true));
el('sosBtn').addEventListener('click', openSosModal);
closeSos.addEventListener('click', closeSosModal);
el('openFirstAidModal').addEventListener('click', openFirstAid);
closeFirstAid.addEventListener('click', closeFirstAidModal);
shareBtn.addEventListener('click', generateAndShowShareLink);
(function init(){
 applyTheme();
 applyLanguage();
 const raw = localStorage.getItem(PROFILE_KEY);
 if (raw && !location.hash) {
       formCard.classList.add('hidden');
       formCard.style.display = 'none';
 } else {
    formCard.style.display = 'block';
    formCard.classList.remove('hidden');
    requestEdit(false);
 }
})();
</script>
</body>
</html>


      
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/4.1.0/anchor.min.js" integrity="sha256-lZaRhKri35AyJSypXXs4o6OPFTbTmUoltBbDCbdzegg=" crossorigin="anonymous"></script>
    <script>anchors.add();</script>
  </body>
</html>
